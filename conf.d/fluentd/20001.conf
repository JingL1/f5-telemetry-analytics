<source>
  @type "#{ENV['FLUENTD_PROTOCAL']}"
  @log_level info
  tag http_input #和下面 match 匹配
  <parse>
    @type json
  </parse>
  port 20001
  bind 0.0.0.0
</source>

<match http_input>
  @type kafka2
  brokers kafka:9093

  use_event_time true

  @id out_general
  <buffer topic>
    @type file

    flush_interval 1s
    flush_thread_count 8
  </buffer>

  <format>
    @type json
  </format>

  # default_topic ltm-fluentd     # need to be same as index prefix
  default_topic general-topic

  required_acks -1
  max_send_limit_bytes 10485760
</match>
